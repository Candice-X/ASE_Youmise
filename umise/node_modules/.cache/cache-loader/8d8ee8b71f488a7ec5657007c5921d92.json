{"remainingRequest":"/Users/kuer/Documents/GitHub/ASE_Youmise/umise/node_modules/babel-loader/lib/index.js!/Users/kuer/Documents/GitHub/ASE_Youmise/umise/node_modules/vue-loader/lib/selector.js?type=script&index=0!/Users/kuer/Documents/GitHub/ASE_Youmise/umise/src/components/Login.vue","dependencies":[{"path":"/Users/kuer/Documents/GitHub/ASE_Youmise/umise/src/components/Login.vue","mtime":1524716411000},{"path":"/Users/kuer/Documents/GitHub/ASE_Youmise/umise/package.json","mtime":1524895759142},{"path":"/Users/kuer/Documents/GitHub/ASE_Youmise/umise/node_modules/cache-loader/dist/cjs.js","mtime":0},{"path":"/Users/kuer/Documents/GitHub/ASE_Youmise/umise/node_modules/babel-loader/lib/index.js","mtime":1519636541000},{"path":"/Users/kuer/Documents/GitHub/ASE_Youmise/umise/node_modules/vue-loader/lib/selector.js","mtime":1520395331000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/kuer/Documents/GitHub/ASE_Youmise/umise/node_modules/@babel/runtime/helpers/asyncToGenerator\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport _objectSpread from \"/Users/kuer/Documents/GitHub/ASE_Youmise/umise/node_modules/@babel/runtime/helpers/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Navbar from \"./Navbar\";\nimport { mapState, mapActions } from \"vuex\";\nimport { required, email, minLength } from \"vuelidate/lib/validators\";\nimport axios from 'axios';\nexport default {\n  name: \"login\",\n  data: function data() {\n    return {\n      userData: {\n        username: \"\",\n        password: \"\"\n      },\n      error: \"\",\n      facebookErr: \"\"\n    };\n  },\n  validations: {\n    userData: {\n      username: {\n        required: required\n      },\n      password: {\n        required: required\n      }\n    }\n  },\n  components: {\n    Navbar: Navbar\n  },\n  created: function created() {\n    this.$store.state.user.isLogin = false;\n    this.$store.dispatch(\"tryAutoLogin\", this.$router);\n  },\n  methods: _objectSpread({}, mapActions([\"login\", \"setAllCardType\"]), {\n    facebookLogin: function facebookLogin() {\n      this.facebookErr = \"\";\n      var a = this;\n      FB.login(function (response) {\n        console.log(response);\n\n        if (response.authResponse) {\n          FB.api('/me', {\n            fields: 'id,name,email'\n          }, function (response) {\n            var resp = null;\n            console.log(response.email);\n            console.log(response.id);\n            a.$store.state.user.facebookid = response.id;\n            a.$store.state.user.email = response.email;\n            var username = response.name.trim().replace(/\\ +/g, \"\");\n            a.$store.state.user.userName = username;\n            console.log(username);\n\n            if (response.email == undefined) {\n              a.facebookErr = \"email is undefined\";\n            }\n\n            try {\n              axios.post('/user/facebooklogin', {\n                \"username\": username,\n                \"email\": response.email,\n                \"facebookid\": response.id\n              }).then(function (response) {\n                resp = response;\n                console.log(response.data);\n                a.$store.state.user.userID = response.data.uid;\n                a.$store.state.user.authenticated = 1;\n                a.$router.push(\"/dashboard\");\n              }); // console.log(\"post login:\", resp);\n              // a.$store.state.user.userID = resp.data.uid;\n            } catch (e) {\n              a.facebookErr = e.message;\n            }\n\n            ;\n          });\n        } else {\n          a.facebookErr = \"User cancelled login or did not fully authorize\";\n        }\n      }, {\n        scope: 'email,user_likes'\n      });\n    },\n    checkFacebookUser: function () {\n      var _checkFacebookUser = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function checkFacebookUser() {\n        return _checkFacebookUser.apply(this, arguments);\n      };\n    }(),\n    handleLogin: function () {\n      var _handleLogin = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        var result;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                this.error = \"\";\n                _context2.next = 4;\n                return this.login(this.userData);\n\n              case 4:\n                result = _context2.sent;\n                console.log(\"result :\", result);\n\n                if (result === 1) {\n                  // this.getAllCardType();\n                  this.$router.push(\"/dashboard\");\n                  console.log(\"login success !\");\n                } else if (result === 2) {\n                  // this.$message({ message: \"You need to set a new password\" });\n                  console.log(\"You have to set a new password !\"); // this.getAllCardType();\n\n                  this.$router.push(\"/mycard\");\n                }\n\n                _context2.next = 13;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](0);\n                this.error = _context2.t0.message;\n                console.log(\"error :\", _context2.t0);\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 9]]);\n      }));\n\n      return function handleLogin() {\n        return _handleLogin.apply(this, arguments);\n      };\n    }()\n  }),\n  computed: _objectSpread({}, mapState({\n    loading: function loading(state) {\n      return state.user.loading;\n    }\n  }))\n};",{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA,AACA,SACA,UACA;AACA,AACA,SACA,UACA,OACA;AACA;AAEA;QAEA;wBACA;;;kBAGA;kBACA,AACA;AAHA;aAIA;mBACA,AACA;AAPA;AAQA;;;;AAIA,AACA;AAFA;;AAIA,AACA,AACA,AAEA;AALA;AAJA;AADA;;AAYA,AACA;AAFA;8BAGA;qCACA;8CACA;AAEA;AACA,kDAEA;4CAEA;yBACA;cACA;mCACA;oBACA;;mCACA;;oBAEA,AACA;AAFA,iCAGA;uBACA;iCAEA;iCACA;sDACA;iDACA;gEACA;2CACA;wBACA;;6CACA;8BACA;AACA;;gBACA;;4BAEA;kCACA;uCACA;AAHA,0CAIA;uBACA;qCACA;2DACA;oDACA;+BACA;AAEA,kBACA;AAEA;wBACA;gCACA;AACA;;;AACA;eACA;0BACA;AACA;;eAGA;;AAEA;AACA,AAEA,AAEA;;;;;;;;;;;;;;;;;;;AACA,AACA;;;;;;;;;;6BACA;;uCACA;;;;wCACA;;kCACA;AACA;oCACA;8BACA;yCACA;AACA;8BACA,qCACA;;oCACA;AACA,AACA;;;;;;;;0CACA;4BACA,AACA,AAEA,AACA;;;;;;;;;;;;;;;AACA;;wBAEA,AACA,AACA;;AAHA;AAjHA","file":"Login.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <body class=\"bg\">\n    <Navbar></Navbar>\n    <div class=\"form-signin\">\n      <div class=\"text-center mb-4\">\n        <img class=\"mb-4\" src=\"../assets/img/Logo.png\" alt=\"\" height=\"72\" width=\"72\">\n        <h1 class=\"h3 mb-3 font-weight-normal\" style=\"color:#fff;\">Umise- Login</h1>\n      </div>\n  \n      <div class=\"form-label-group\" :class=\"{invalid: $v.userData.username.$error }\">\n        <input id=\"inputEmail\" class=\"form-control\" placeholder=\"User Name\" autofocus=\"\" \n        @blur=\"$v.userData.username.$touch()\" v-model=\"userData.username\">\n        <label for=\"inputEmail\">User Name</label>\n      </div>\n  \n      <div class=\"form-label-group\" :class=\"{invalid: $v.userData.password.$error }\">\n        <input id=\"inputPassword\" class=\"form-control\" placeholder=\"Password\" type=\"password\" \n        @blur=\"$v.userData.password.$touch()\" v-model=\"userData.password\">\n        <label for=\"inputPassword\">Password</label>\n      </div>\n  \n      <div class=\"checkbox mb-3\">\n        <label style=\"color:red\">\n            {{ error }}\n          </label>\n      </div>\n      <button class=\"btn btn-lg btn-success btn-block\" :disabled=\"$v.userData.$invalid\" @click=\"handleLogin\" \n      @keyup.enter=\"handleLogin\">Sign in</button>\n      <router-link to=\"/resetPassword\" tag=\"a\">\n        <p style=\"color:#dcdcdc;text-align:center;padding-top:10px;\">Forget Password ?</p>\n      </router-link>\n      <div>\n        <!-- <div class=\"fb-login-button\" data-max-rows=\"1\" data-size=\"large\" data-button-type=\"continue_with\" \n        data-show-faces=\"true\" data-auto-logout-link=\"true\" data-use-continue-as=\"true\" onlogin=\"checkLoginState\"></div> -->\n        <p style=\"text-align:center;\">or</p>\n        <div class=\"btn btn-primary fb-login-button12\" scope=\"public_profile,email\" @click=\"facebookLogin\">\n          <span></span> Login with facebook\n        </div>\n        {{ facebookErr }}\n      </div>\n      <!-- <p class=\"mt-5 mb-3 text-muted text-center\">Don't have a account,<router-link to=\"/signup\"> Sign up</router-link></p> --> \n    </div>\n  </body>\n</template>\n\n<script>\n  import Navbar from \"./Navbar\";\n  import {\n    mapState,\n    mapActions\n  } from \"vuex\";\n  import {\n    required,\n    email,\n    minLength\n  } from \"vuelidate/lib/validators\";\n  import axios from 'axios';\n  \n  export default {\n    name: \"login\",\n    data() {\n      return {\n        userData: {\n          username: \"\",\n          password: \"\"\n        },\n        error: \"\",\n        facebookErr: \"\",\n      };\n    },\n    validations: {\n      userData: {\n        username: {\n          required,\n        },\n        password: {\n          required,\n        }\n      }\n    },\n  \n    components: {\n      Navbar,\n    },\n    created: function() {\n      this.$store.state.user.isLogin = false;\n      this.$store.dispatch(\"tryAutoLogin\", this.$router);\n    },\n  \n    methods: {\n      ...mapActions([\"login\", \"setAllCardType\"]),\n  \n      facebookLogin() {\n\n        this.facebookErr = \"\";\n        var a = this;\n        FB.login(function(response) {\n          console.log(response);\n          if (response.authResponse) {\n            FB.api('/me', {\n                fields: 'id,name,email'\n              },\n              function(response) {\n                let resp = null;\n                console.log(response.email);\n              \n                console.log(response.id);\n                a.$store.state.user.facebookid = response.id;\n                a.$store.state.user.email = response.email;\n                let username = response.name.trim().replace(/\\ +/g,\"\");\n                a.$store.state.user.userName = username;\n                console.log(username);\n                if(response.email==undefined){\n                  a.facebookErr = \"email is undefined\";\n                }\n                try {\n                  axios.post('/user/facebooklogin', {\n                    \"username\": username,\n                    \"email\": response.email,\n                    \"facebookid\": response.id\n                  }).then((response)=>{\n                    resp = response;\n                    console.log(response.data);\n                    a.$store.state.user.userID = response.data.uid;\n                    a.$store.state.user.authenticated = 1;\n                    a.$router.push(\"/dashboard\");\n                  });\n\n                  // console.log(\"post login:\", resp);\n                  // a.$store.state.user.userID = resp.data.uid;\n                 \n                } catch (e) {\n                   a.facebookErr = e.message;\n                };\n              });\n          } else {\n            a.facebookErr = \"User cancelled login or did not fully authorize\";\n          }\n        },{scope:'email,user_likes'});\n  \n  \n      },\n   \n      async checkFacebookUser() {\n        // 1. search for user by username?\n  \n      },\n  \n      async handleLogin() {\n        try {\n          this.error = \"\";\n          const result = await this.login(this.userData);\n          console.log(\"result :\", result);\n          if (result === 1) {\n            // this.getAllCardType();\n            this.$router.push(\"/dashboard\");\n            console.log(\"login success !\");\n          } else if (result === 2) {\n            // this.$message({ message: \"You need to set a new password\" });\n            console.log(\"You have to set a new password !\");\n            // this.getAllCardType();\n            this.$router.push(\"/mycard\");\n          }\n        } catch (e) {\n          this.error = e.message;\n          console.log(\"error :\", e);\n        }\n      },\n  \n    },\n    computed: {\n      ...mapState({\n        loading: state => state.user.loading\n      }),\n    },\n  };\n</script>\n\n<style scoped>\n  :root,\n  body {\n    --input-padding-x: 0.75rem;\n    --input-padding-y: 0.75rem;\n  }\n  \n  body {\n    display: -ms-flexbox;\n    display: -webkit-box;\n    display: flex;\n    -ms-flex-align: center;\n    -ms-flex-pack: center;\n    -webkit-box-align: center;\n    align-items: center;\n    -webkit-box-pack: center;\n    justify-content: center;\n    background-color: #f5f5f5;\n    width: 100%;\n    height: 100vh;\n    min-height: 775px;\n    padding-top: 0;\n    /* margin-top:-60px; */\n    padding-bottom: 0;\n    background-image: url(\"../assets/img/bg2.jpg\");\n    background-size: cover;\n    color: #eee;\n  }\n  \n  img {\n    border: 0.3rem solid rgba(255, 255, 255, 0.5);\n    border-radius: 50%;\n  }\n  \n  .form-signin {\n    width: 100%;\n    max-width: 420px;\n    padding: 15px;\n    margin: 0 auto;\n  }\n  \n  .form-label-group {\n    position: relative;\n    margin-bottom: 1rem;\n  }\n  \n  .form-label-group>input,\n  .form-label-group>label {\n    padding: var(--input-padding-y) var(--input-padding-x);\n  }\n  \n  .form-label-group>label {\n    position: absolute;\n    top: 0;\n    left: 0;\n    display: block;\n    width: 100%;\n    margin-bottom: 0;\n    /* Override default `<label>` margin */\n    line-height: 1.5;\n    color: #495057;\n    border: 1px solid transparent;\n    border-radius: 0.25rem;\n    transition: all 0.1s ease-in-out;\n  }\n  \n  .form-label-group input::-webkit-input-placeholder {\n    color: transparent;\n  }\n  \n  .form-label-group input:-ms-input-placeholder {\n    color: transparent;\n  }\n  \n  .form-label-group input::-ms-input-placeholder {\n    color: transparent;\n  }\n  \n  .form-label-group input::-moz-placeholder {\n    color: transparent;\n  }\n  \n  .form-label-group input::placeholder {\n    color: transparent;\n  }\n  \n  .form-label-group input:not(:placeholder-shown) {\n    padding-top: calc(var(--input-padding-y) + var(--input-padding-y) * (2 / 3));\n    padding-bottom: calc(var(--input-padding-y) / 3);\n  }\n  \n  .form-label-group input:not(:placeholder-shown)~label {\n    padding-top: calc(var(--input-padding-y) / 3);\n    padding-bottom: calc(var(--input-padding-y) / 3);\n    font-size: 12px;\n    color: #777;\n  }\n  \n  .form-label-group.invalid input {\n    border: 1px solid red;\n    background: #ffc9aa;\n  }\n  \n  .fb-login-button12 {\n    background: #4c69ba;\n    background: linear-gradient(#4c69ba, #3b55a0);\n    border-color: #4c69ba;\n    border-radius: 4px;\n    color: #fff;\n    width: 100%;\n    height: 48px;\n  }\n</style>\n"]}]}